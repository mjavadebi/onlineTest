<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>آزمون سبک یادگیری فلدر-سیلورمن</title>
  <style>
    /* Import Vazirmatn font from Google Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');

    body {
      font-family: 'Vazirmatn', Arial, sans-serif;
      background: #f4f4f4;
      padding: 2rem;
      direction: rtl;
    }
    h1, h2 {
      text-align: center;
    }
    .user-info {
      background: white;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .user-info h2 {
      margin-top: 0;
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
    }
    .form-group {
      margin-bottom: 1rem;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    .form-group input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box; /* Important for padding and width */
      font-family: 'Vazirmatn', sans-serif;
    }
    .question {
      background: white;
      padding: 1.5rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question h3 {
      margin-bottom: 1rem;
      text-align: right;
      font-size: 1.1rem;
      line-height: 1.6;
    }
    .options label {
      display: block;
      margin-bottom: 0.5rem;
      text-align: right;
      cursor: pointer;
    }
    .options input {
      margin-left: 0.5rem;
    }
    .result {
      margin-top: 2rem;
      padding: 1.5rem;
      background: #e9f5e9;
      border: 1px solid #c8e6c9;
      border-radius: 8px;
      font-size: 1.1rem; /* Adjusted font size for better readability */
      font-weight: normal; /* Adjusted font weight */
      text-align: right; /* Align text to the right */
      line-height: 2.0; /* Adjusted line height */
      white-space: pre-wrap; /* Ensures line breaks are respected */
    }
    .result h3 {
        text-align: center;
        font-size: 1.4rem;
        margin-bottom: 1rem;
    }
    .result p {
        margin-bottom: 0.5rem;
    }
    .result strong {
        font-weight: bold;
    }
    .result hr {
        border: 0;
        border-top: 1px solid #c8e6c9;
        margin: 1.5rem 0;
    }
    button[type="submit"] {
      display: block;
      margin: 2rem auto;
      padding: 0.8rem 1.5rem;
      font-size: 1.2rem;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-family: 'Vazirmatn', sans-serif;
      transition: background-color 0.3s;
    }
    button[type="submit"]:hover:not(:disabled) {
      background-color: #0056b3;
    }
    button[type="submit"]:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    .back-button {
      display: block;
      margin: 2rem auto;
      text-align: center;
      color: #007bff;
      cursor: pointer;
      text-decoration: underline;
      font-size: 1rem;
      max-width: 150px;
    }
    .back-button:hover {
      color: #0056b3;
    }
    .error-message {
        color: #D8000C;
        background-color: #FFD2D2;
        border: 1px solid #D8000C;
        border-radius: 5px;
        padding: 1rem;
        margin: 1rem auto;
        text-align: center;
        display: none; /* Hidden by default */
    }
  </style>
</head>
<body>
  <h1>آزمون سبک یادگیری فلدر-سیلورمن</h1>
  <form id="quizForm">
    <div class="user-info">
      <h2>اطلاعات (اختیاری)</h2>
      <div class="form-group">
        <label for="name">نام و نام خانوادگی</label>
        <input type="text" id="name" name="name" placeholder="مثال: مریم رضایی">
      </div>
      <div class="form-group">
        <label for="age">سن</label>
        <input type="number" id="age" name="age" placeholder="مثال: ۲۱">
      </div>
      <div class="form-group">
        <label for="phoneNumber">شماره تلفن</label>
        <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="مثال: ۰۹۱۲۳۴۵۶۷۸۹">
      </div>
      <div class="form-group">
        <label for="studentId">شماره دانشجویی</label>
        <input type="text" id="studentId" name="studentId" placeholder="مثال: ۹۸۷۶۵۴۳۲۱">
      </div>
    </div>
    
    <div id="questions"></div>
    <button type="submit" id="submitBtn">محاسبه سبک یادگیری من</button>
  </form>
  
  <div id="result" class="result" style="display: none;"></div>
  <div id="errorMessage" class="error-message"></div>

  <div class="back-button" onclick="window.location.href='index.html'">
    → بازگشت به صفحه اصلی
  </div>

  <script>
    const questions = [
        { q: "۱) هنگامی مطلب را بهتر می فهمیم که:", a: "الف) آن را آزمایش می کنم.", b: "ب) درباره آن کاملاً فکر می کنم.", dim: "ACT-REF" },
        { q: "۲) ترجیح می دهم:", a: "الف) واقع بین به نظر برسم.", b: "ب) مبتکر به نظر برسم.", dim: "SEN-INT" },
        { q: "۳) وقتی به آنچه دیروز انجام داده ام فکر می کنم، بیشتر:", a: "الف) آن را به صورت تصویر به یاد می آورم.", b: "ب) آن را به صورت کلمات به یاد می آورم.", dim: "VIS-VRB" },
        { q: "۴) معمولاً:", a: "الف) جزئیات موضوع را می فهمم، اما درباره ساختار کلی آن گیج می شوم.", b: "ب) ساختار کلی موضوع را می فهمم، اما درباره جزئیات آن گیج می شوم.", dim: "SEQ-GLO" },
        { q: "۵) برای یادگیری هر چیز تازه:", a: "الف) صحبت کردن درباره آن به من کمک می کند.", b: "ب) فکر کردن درباره آن به من کمک می کند.", dim: "ACT-REF" },
        { q: "۶) اگر معلم شوم، ترجیح می دهم درسی بدهم که:", a: "الف) با حقایق زندگی سروکار داشته باشد.", b: "ب) با عقاید و نظریه ها سروکار داشته باشد.", dim: "SEN-INT" },
        { q: "۷) ترجیح می دهم مطالب جدید را از طریق:", a: "الف) تصاویر، جدولها و نقشه ها یاد بگیرم.", b: "ب) دستورالعملهای مکتوب یا اطلاعات شفاهی یاد بگیرم.", dim: "VIS-VRB" },
        { q: "۸) وقتی:", a: "الف) همه اجزای مطلب را بفهمم، کل مطلب را می فهمم.", b: "ب) کل مطلب را بفهمم، همه اجزای آن را می فهمم.", dim: "SEQ-GLO" },
        { q: "۹) در میان گروهی که مسئله دشواری را بررسی می کنند، من به احتمال زیاد:", a: "الف) وارد بحث می شوم و عقیده ام را بیان می کنم.", b: "ب) در گوشه ای می نشینم و گوش می دهم.", dim: "ACT-REF" },
        { q: "۱۰) یادگیری:", a: "الف) واقعیات را آسان تر می دانم.", b: "ب) مفاهیم را آسان تر می دانم.", dim: "SEN-INT" },
        { q: "۱۱) هنگام مطالعه کتابی که تصاویر و شکلهای بسیار زیادی دارد، به احتمال زیاد:", a: "الف) تصاویر و نمودارها را به دقت بررسی می کنم.", b: "ب) توجه خود را به نوشته های کتاب معطوف می کنم.", dim: "VIS-VRB" },
        { q: "۱۲) هنگام حل مسائل ریاضی:", a: "الف) معمولاً مرحله به مرحله روی راه حلهایی که به جواب می رسند کار می کنم.", b: "ب) غالباً ابتدا راه حلها را بررسی می کنم و سپس سعی می کنم مراحلی که برای رسیدن به آنها لازم است بیابم.", dim: "SEQ-GLO" },
        { q: "۱۳) وقتی در کلاسی شرکت می کنم:", a: "الف) معمولاً با بسیاری از دانش آموزان آشنا می شوم.", b: "ب) معمولاً با تعداد کمی از دانش آموزان آشنا می شوم.", dim: "ACT-REF" },
        { q: "۱۴) در مطالعه مطالب واقعی، ترجیح می دهم مطالب:", a: "الف) چیزهای جدیدی به من بیاموزند یا به من چگونگی انجام دادن کارها را یاد بدهند.", b: "ب) ایده های جدیدی برای فکر کردن درباره آنها در اختیار من بگذراند.", dim: "SEN-INT" },
        { q: "۱۵) معلمانی را دوست دارم که هنگام درس دادن:", a: "الف) جدولها و نمودارهای زیادی روی تخته می کشند.", b: "ب) زمان زیادی را صرف توضیح دادن می کنند.", dim: "VIS-VRB" },
        { q: "۱۶) هنگام تحلیل داستان یا رمان:", a: "الف) به اتفاقات داستان فکر می کنم و می کوشم آنها را به منظور فهم موضوع اصلی داستان به یکدیگر مرتبط سازم.", b: "ب) چون وقتی که داستان را تمام می کنم فقط موضوع اصلی آن را به خاطر می آورم، باید به عقب برگردم و رابطه بین اتفاقهای داستان را پیدا کنم.", dim: "SEQ-GLO" },
        { q: "۱۷) وقتی حل مسئله را شروع می کنم، به احتمال زیاد:", a: "الف) بلافاصله روی راه حل آن کار می کنم.", b: "ب) ابتدا سعی می کنم مسئله را کاملاً بفهمم.", dim: "ACT-REF" },
        { q: "۱۸) بیشتر:", a: "الف) عقاید قطعی را ترجیح می دهم.", b: "ب) فرضیات را ترجیح می دهم.", dim: "SEN-INT" },
        { q: "۱۹) آنچه را:", a: "الف) می بینم بهتر به یاد می آورم.", b: "ب) می شنوم بهتر به یاد می آورم.", dim: "VIS-VRB" },
        { q: "۲۰) برای من خیلی مهم است که معلم:", a: "الف) مطالب را با نظم و ترتیب روشن ارائه دهد.", b: "ب) تصویری کلی از مطالب را ارائه دهد و آن را با موضوعات دیگر مرتبط سازد.", dim: "SEQ-GLO" },
        { q: "۲۱) ترجیح می دهم:", a: "الف) در گروه مطالعه کنم.", b: "ب) به تنهایی مطالعه کنم.", dim: "ACT-REF" },
        { q: "۲۲) بیشتر ترجیح می دهم:", a: "الف) درباره جزئیات کار دقیق باشم.", b: "ب) در چگونگی انجام دادن کار خلاق باشم.", dim: "SEN-INT" },
        { q: "۲۳) برای پیدا کردن محلی ناآشنا:", a: "الف) استفاده از نقشه را ترجیح می دهم.", b: "ب) استفاده از آدرس مکتوب را ترجیح می دهم.", dim: "VIS-VRB" },
        { q: "۲۴) مطالب را:", a: "الف) در مراحل نسبتاً منظم و با تلاش زیاد یاد می گیرم.", b: "ب) در ابتدا خوب نمی فهمم و کاملاً گیج می شوم، اما ناگهان آن را یاد می گیرم.", dim: "SEQ-GLO" },
        { q: "۲۵) ترجیح می دهم ابتدا:", a: "الف) کارها را انجام دهم.", b: "ب) در باره چگونگی انجام دادن کارها فکر کنم.", dim: "ACT-REF" },
        { q: "۲۶) وقتی برای سرگرمی مطالعه می کنم، نویسندگانی را ترجیح می دهم که:", a: "الف) به روشنی منظورشان را بیان می کنند.", b: "ب) مطالب را به روشهای جالب و خلاق بیان می کنند.", dim: "SEN-INT" },
        { q: "۲۷) وقتی در کلاس تصویر یا شکلی می بینم، احتمال زیادی وجود دارد که:", a: "الف) تصویر یا شکل را به یاد بیاورم.", b: "ب) توضیحات معلم درباره تصویر یا شکل را به یاد بیاورم.", dim: "VIS-VRB" },
        { q: "۲۸) هنگامی که با اطلاعات زیادی مواجه می شوم به احتمال زیاد:", a: "الف) به جزئیات توجه می کنم و اصل مطلب را از دست می دهم.", b: "ب) سعی می کنم، قبل از پرداختن به جزئیات، اصل مطلب را بفهمم.", dim: "SEQ-GLO" },
        { q: "۲۹) یادآوری:", a: "الف) آنچه را انجام داده ام آسان تر می دانم.", b: "ب) آنچه را درباره اش زیاد فکر کرده ام، آسان تر می دانم.", dim: "ACT-REF" },
        { q: "۳۰) وقتی باید کاری انجام دهم، ترجیح می دهم:", a: "الف) برای انجام دادن آن در یکی از روشهای موجود مهارت کسب کنم.", b: "ب) روشهای جدیدی ابداع کنم و به کار گیرم.", dim: "SEN-INT" },
        { q: "۳۱) وقتی فردی متنی به من نشان می دهد:", a: "الف) شکلها و تصاویر آن را ترجیح می دهم.", b: "ب) خلاصه متن و نتایج آن را ترجیح می دهم.", dim: "VIS-VRB" },
        { q: "۳۲) برای تدوین مقاله، به احتمال زیاد:", a: "الف) نگارش مقاله را از ابتدا شروع می کنم و با رعایت ترتیب بخشها ادامه می دهم.", b: "ب) بخشهای مختلف مقاله را بدون توجه به ترتیب آنها آماده و سپس مرتب می کنم.", dim: "SEQ-GLO" },
        { q: "۳۳) وقتی باید با دیگران به صورت گروهی کار کنم، مایلم در آغاز:", a: "الف) هر یک از افراد گروه عقاید و نظرهایشان را مطرح کنند.", b: "ب) افراد عقاید خود را ابتدا به صورت انفرادی بررسی و سپس در گروه مطرح کنند.", dim: "ACT-REF" },
        { q: "۳۴) به نظر من بالاترین تمجید آن است که فرد را:", a: "الف) معقول بدانیم.", b: "ب) دارای تخیل قوی بدانیم.", dim: "SEN-INT" },
        { q: "۳۵) اگر افرادی را در میهمانی ملاقات کنم، احتمال زیادی وجود دارد که:", a: "الف) چهره آنها را به یاد بیاورم.", b: "ب) آنچه را درباره خودشان گفته اند به یاد بیاورم.", dim: "VIS-VRB" },
        { q: "۳۶) وقتی موضوع جدیدی یاد می گیرم، ترجیح می دهم:", a: "الف) بر آن متمرکز شوم و تا آنجا که می توانم درباره آن مطالبی یاد بگیرم.", b: "ب) آن موضوع را با موضعهای دیگر مرتبط کنم.", dim: "SEQ-GLO" },
        { q: "۳۷) به نظر دیگران، من:", a: "الف) خوش برخورد به شمار می آیم.", b: "ب) خوددار به شمار می آیم.", dim: "ACT-REF" },
        { q: "۳۸) دروسی را ترجیح می دهم که بر:", a: "الف) موضوعات عینی مانند واقعیات و اطلاعات متمرکز باشند.", b: "ب) موضوعات انتزاعی مانند مفاهیم و نظریه ها متمرکز باشند.", dim: "SEN-INT" },
        { q: "۳۹) برای سرگرمی، ترجیح می دهم:", a: "الف) تلویزیون تماشا کنم.", b: "ب) کتاب بخوانم.", dim: "VIS-VRB" },
        { q: "۴۰) بعضی از معلمان درس خود را با خلاصه ای از موضوع مورد بحث شروع می کنند، این خلاصه ها برای من:", a: "الف) کمی مفید هستند.", b: "ب) بسیار مفید هستند.", dim: "SEQ-GLO" },
        { q: "۴۱) وقتی تکلیف به صورت گروهی انجام می شود، اختصاص یک نمره برای کل گروه:", a: "الف) درست است.", b: "ب) درست نیست.", dim: "ACT-REF" },
        { q: "۴۲) در محاسبات طولانی، تمایل به:", a: "الف) مرور تمامی مراحل و کنترل دقیق محاسبات دارم.", b: "ب) مرور تمامی مراحل و کنترل دقیق محاسبات ندارم و باید خود را مجبور به انجام دادن آن کنم.", dim: "SEN-INT" },
        { q: "۴۳) تجسم مکانهایی که در آنها بوده ام برای من:", a: "الف) نسبتاً آسان، کامل و دقیق است.", b: "ب) دشوار، بدون جزئیات و بی دقت است.", dim: "VIS-VRB" },
        { q: "۴۴) هنگام حل مسائل به صورت گروهی، بیشتر مایلم:", a: "الف) در مورد مراحل حل مسئله فکر کنم.", b: "ب) درباره نتایج و کاربردهای احتمالی راه حلها فکر کنم.", dim: "SEQ-GLO" }
    ];

    // *** NEW: Descriptions for each learning style ***
    const learningStyleDescriptions = {
        'Active': '<strong>فعال (Active):</strong> شما با انجام دادن کارها، مشارکت در بحث و توضیح دادن به دیگران بهتر یاد می‌گیرید. کار گروهی برای شما لذت‌بخش است.',
        'Reflective': '<strong>تأمل‌گرا (Reflective):</strong> شما ترجیح می‌دهید قبل از هر کاری، درباره‌ی آن فکر کنید. مطالعه‌ی فردی و کار در محیطی آرام به یادگیری شما کمک می‌کند.',
        'Sensing': '<strong>حسی (Sensing):</strong> شما به واقعیت‌ها، داده‌های ملموس و رویه‌های مشخص علاقه‌مند هستید. در به خاطر سپردن جزئیات مهارت دارید و روش‌های عملی را ترجیح می‌دهید.',
        'Intuitive': '<strong>شهودی (Intuitive):</strong> شما به مفاهیم، نظریه‌ها و کشف روابط جدید علاقه‌مندید. از کارهای تکراری خسته می‌شوید و ایده‌های نوآورانه را دوست دارید.',
        'Visual': '<strong>دیداری (Visual):</strong> شما با دیدن تصاویر، نمودارها، دیاگرام‌ها و نمایش‌های بصری بهتر یاد می‌گیرید. حافظه‌ی تصویری خوبی دارید.',
        'Verbal': '<strong>کلامی (Verbal):</strong> شما از طریق توضیحات نوشتاری و گفتاری بهتر یاد می‌گیرید. خواندن، نوشتن و بحث کردن به فرآیند یادگیری شما کمک می‌کند.',
        'Sequential': '<strong>توالی‌گرا (Sequential):</strong> شما اطلاعات را به صورت مرحله به مرحله و منظم دنبال می‌کنید. با دنبال کردن یک مسیر منطقی، به درک عمیقی از موضوع می‌رسید.',
        'Global': '<strong>کلی‌نگر (Global):</strong> شما نیاز دارید ابتدا تصویر کلی و هدف نهایی را درک کنید. شما به صورت جهشی و با درک ناگهانی مطلب را یاد می‌گیرید و سپس به جزئیات می‌پردازید.'
    };

    const container = document.getElementById("questions");
    questions.forEach((q, i) => {
      const div = document.createElement("div");
      div.className = "question";
      div.innerHTML = `
        <h3>${q.q}</h3>
        <div class="options">
          <label><input type="radio" name="q${i}" value="a" required> ${q.a}</label>
          <label><input type="radio" name="q${i}" value="b" required> ${q.b}</label>
        </div>
      `;
      container.appendChild(div);
    });

    const form = document.getElementById("quizForm");
    const submitBtn = document.getElementById('submitBtn');
    const resultDiv = document.getElementById('result');
    const errorDiv = document.getElementById('errorMessage');

    form.onsubmit = function(e) {
      e.preventDefault();

      submitBtn.disabled = true;
      submitBtn.innerText = 'در حال ارسال...';
      resultDiv.style.display = 'none';
      errorDiv.style.display = 'none';

      const userInfo = {
        Name: document.getElementById('name').value,
        Age: document.getElementById('age').value,
        PhoneNumber: document.getElementById('phoneNumber').value,
        StudentID: document.getElementById('studentId').value,
      };

      const scores = { "ACT-REF": 0, "SEN-INT": 0, "VIS-VRB": 0, "SEQ-GLO": 0 };
      const individualAnswers = {};
      
      questions.forEach((q, i) => {
        const val = document.querySelector(`input[name='q${i}']:checked`).value;
        scores[q.dim] += (val === 'a' ? 1 : -1);
        const questionKey = `Q${i + 1}-${q.dim}`;
        individualAnswers[questionKey] = val;
      });

      const calculateStyleAndPercentage = (score, styleA, styleB) => {
        const totalQuestionsPerDimension = 11;
        if (score === 0) return "متعادل (Balanced)";
        const percentage = Math.round((Math.abs(score) / totalQuestionsPerDimension) * 100);
        const dominantStyle = score > 0 ? styleA : styleB;
        return `${dominantStyle} (${percentage}%)`;
      };

      const finalResults = {
        Result_ACT_REF: calculateStyleAndPercentage(scores["ACT-REF"], "فعال (Active)", "تأمل‌گرا (Reflective)"),
        Result_SEN_INT: calculateStyleAndPercentage(scores["SEN-INT"], "حسی (Sensing)", "شهودی (Intuitive)"),
        Result_VIS_VRB: calculateStyleAndPercentage(scores["VIS-VRB"], "دیداری (Visual)", "کلامی (Verbal)"),
        Result_SEQ_GLO: calculateStyleAndPercentage(scores["SEQ-GLO"], "توالی‌گرا (Sequential)", "کلی‌نگر (Global)")
      };
      
      // *** NEW: Generate descriptions based on scores ***
      let descriptionsHtml = '<h3>توضیحات سبک یادگیری شما</h3>';
      descriptionsHtml += `<p>${scores["ACT-REF"] >= 0 ? learningStyleDescriptions.Active : learningStyleDescriptions.Reflective}</p>`;
      descriptionsHtml += `<p>${scores["SEN-INT"] >= 0 ? learningStyleDescriptions.Sensing : learningStyleDescriptions.Intuitive}</p>`;
      descriptionsHtml += `<p>${scores["VIS-VRB"] >= 0 ? learningStyleDescriptions.Visual : learningStyleDescriptions.Verbal}</p>`;
      descriptionsHtml += `<p>${scores["SEQ-GLO"] >= 0 ? learningStyleDescriptions.Sequential : learningStyleDescriptions.Global}</p>`;

      const dataToSend = { ...userInfo, ...individualAnswers, ...finalResults };

      fetch("https://script.google.com/macros/s/AKfycbxFwNMP0a-r96encgGGSweBkcRnKeEmIpTcdUYHojz3UoirL50lEXjVMpC4vCHHBX0yLA/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(dataToSend)
      }).then(() => {
        const resultSummary = `
          <h3>نتایج آزمون</h3>
          <p><strong>فعالیت:</strong> ${finalResults.Result_ACT_REF}</p>
          <p><strong>دریافت اطلاعات:</strong> ${finalResults.Result_SEN_INT}</p>
          <p><strong>شیوه ارائه اطلاعات:</strong> ${finalResults.Result_VIS_VRB}</p>
          <p><strong>پردازش اطلاعات:</strong> ${finalResults.Result_SEQ_GLO}</p>
        `;
        
        // Combine summary and descriptions
        resultDiv.innerHTML = resultSummary + '<hr>' + descriptionsHtml;
        resultDiv.style.display = 'block';
        submitBtn.innerText = 'ارسال انجام شد';
        
      }).catch(err => {
        errorDiv.innerText = "خطایی در ارسال اطلاعات به Google Sheet رخ داد. لطفاً اتصال اینترنت خود را بررسی کرده و دوباره تلاش کنید.";
        errorDiv.style.display = 'block';
        console.error(err);
        submitBtn.disabled = false;
        submitBtn.innerText = 'محاسبه سبک یادگیری من';
      });
    };
  </script>
</body>
</html>
